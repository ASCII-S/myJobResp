---
created: '2025-10-19'
last_reviewed: null
next_review: '2025-10-19'
review_count: 0
difficulty: medium
mastery_level: 0.0
tags:
- C++
- C++/简述虚析构函数及作用.md
related_outlines: []
---
# 简述虚析构函数及作用


###  面试标准回答

“虚析构函数是指把基类析构函数声明为 `virtual`。
它的作用是在通过基类指针删除派生类对象时，能够保证先调用派生类的析构函数，再调用基类析构函数，从而避免资源泄漏。
如果基类不是虚析构，`delete` 基类指针只会执行基类析构逻辑，派生类部分无法正确释放。一般只要类设计成多态类，就应该让析构函数为虚函数。”

---

### 1. 问题背景

在多态使用中，我们经常写：

```cpp
Base* p = new Derived();
delete p;   // 通过基类指针删除派生类对象
```

如果基类的析构函数 **不是虚函数**：

* `delete p;` 只会调用 `Base` 的析构函数。
* `Derived` 部分不会被析构，可能导致内存泄漏或资源没释放。

---

### 2. 虚析构函数的作用

* 把基类的析构函数声明为 `virtual`：

  ```cpp
  class Base {
  public:
      virtual ~Base() { ... }
  };
  ```
* 这样通过基类指针删除对象时，会先调用 `Derived::~Derived()`，再调用 `Base::~Base()`，保证整个对象正确销毁。
* 这是 **多态类设计的必备规范**：只要类里有虚函数，析构函数几乎一定要写成虚的。

---

### 3. 注意点

* 析构函数一旦声明为虚函数，编译器会为类生成虚函数表（如果之前还没有）。
* 抽象类也常常会写一个虚析构函数，即使它没资源要释放，这样可以保证继承它的类通过基类指针安全析构。
* 代价：每个对象会多出一个 `vptr`（虚函数表指针），但这点开销通常值得。

---

---

## 相关笔记
<!-- 自动生成 -->

暂无相关笔记

